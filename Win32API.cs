using System;
using System.Runtime.InteropServices;

namespace ScreenMagnifier
{
	class Win32API
	{
		#region DLL导入

		/// <summary>
		/// 用于设置窗口
		/// </summary>
		/// <param name="hWnd"></param>
		/// <param name="hWndInsertAfter"></param>
		/// <param name="X"></param>
		/// <param name="Y"></param>
		/// <param name="cx"></param>
		/// <param name="cy"></param>
		/// <param name="uFlags"></param>
		/// <returns></returns>
		[DllImport( "user32.dll", CallingConvention = CallingConvention.StdCall )]
		public static extern bool SetWindowPos ( IntPtr hWnd, int hWndInsertAfter, 
			int X, int Y, int cx, int cy, int uFlags );

		/// <summary>
		/// 安装钩子
		/// </summary>
		/// <param name="idHook"></param>
		/// <param name="lpfn"></param>
		/// <param name="hInstance"></param>
		/// <param name="threadId"></param>
		/// <returns></returns>
		[DllImport( "user32.dll", CallingConvention = CallingConvention.StdCall )]
		public static extern IntPtr SetWindowsHookEx ( WH_Codes idHook, HookProc lpfn,
			IntPtr pInstance, int threadId );

		/// <summary>
		/// 卸载钩子
		/// </summary>
		/// <param name="idHook"></param>
		/// <returns></returns>
		[DllImport( "user32.dll", CallingConvention = CallingConvention.StdCall )]
		public static extern bool UnhookWindowsHookEx ( IntPtr pHookHandle );

		/// <summary>
		/// 传递钩子
		/// </summary>
		/// <param name="idHook"></param>
		/// <param name="nCode"></param>
		/// <param name="wParam"></param>
		/// <param name="lParam"></param>
		/// <returns></returns>
		[DllImport( "user32.dll", CallingConvention = CallingConvention.StdCall )]
		public static extern int CallNextHookEx ( IntPtr pHookHandle, int nCode,
			Int32 wParam, IntPtr lParam );

		/// <summary>
		/// 转换当前按键信息
		/// </summary>
		/// <param name="uVirtKey"></param>
		/// <param name="uScanCode"></param>
		/// <param name="lpbKeyState"></param>
		/// <param name="lpwTransKey"></param>
		/// <param name="fuState"></param>
		/// <returns></returns>
		[DllImport( "user32.dll" )]
		public static extern int ToAscii( UInt32 uVirtKey, UInt32 uScanCode,
			byte[] lpbKeyState, byte[] lpwTransKey, UInt32 fuState );

		/// <summary>
		/// 获取按键状态
		/// </summary>
		/// <param name="pbKeyState"></param>
		/// <returns>非0表示成功</returns>
		[DllImport( "user32.dll" )]
		public static extern int GetKeyboardState( byte[] pbKeyState );

		/// <summary>
		/// 获取当前鼠标位置
		/// </summary>
		/// <param name="lpPoint"></param>
		/// <returns></returns>
		[DllImport("user32.dll")]
		public extern static int GetCursorPos( ref POINT lpPoint ); 


		#endregion DLL导入
	}
}
